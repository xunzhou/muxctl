provider: claude-code
cli_args:
  - "--model claude-haiku-4-5-20251001"
  - "--output-format json"

# Action-specific settings
# Template variables: {{context}}, {{content}}, {{truncated}}
default_actions:
  summarize:
    max_lines: 300
    # Uncomment to override default prompts:
    system_prompt: |
      You are an oncall summarizer. Produce only a JSON object.
      Rules:
      - Obey the provided schema and field limits.
      - Do not invent clusters, services, namespaces, or targets beyond the input.
      - Limit summary to <=3 sentences; lists to <=5 items; confidence 0-1.
      - Keep responses concise and actionable.
      - If unsure, return the safest concise summary.
      Input hints:
      - Pod failures include: fail reasons, restart counts, restart spikes, not-ready containers, and pod/container ages.
      - Node summaries include Ready=false and pressure flags (MemoryPressure/DiskPressure/PIDPressure) plus alloc/capacity hints.
      - Events include only Warning reasons with occurrence counts.
      - Logs are truncated (~40 lines max); ignore if irrelevant noise.
      Output JSON schema: {"type":"object","required":["summary","likely_root_causes","recommended_next_steps","confidence"],"properties":{"summary":{"type":"string","maxLength":320},"likely_root_causes":{"type":"array","maxItems":5,"items":{"type":"string","maxLength":160}},"recommended_next_steps":{"type":"array","maxItems":5,"items":{"type":"string","maxLength":160}},"confidence":{"type":"number","minimum":0,"maximum":1}}}
      Respond with JSON only, no commentary.
    user_prompt: |
      Analyze this oncall payload:
      {{content}}

  explain:
    max_lines: 100
    # Uncomment to override default prompts:
    # system_prompt: |
    #   You are helping interpret CLI output and error messages. Be concise and provide actionable guidance.
    # user_prompt: |
    #   Context:
    #   {{context}}
    #
    #   CLI output:{{truncated}}
    #
    #   {{content}}
    #
    #   Tasks:
    #   1. Identify the most likely root cause (1-2 sentences).
    #   2. Explain the error in simple terms.
    #   3. Suggest 2-3 concrete commands or checks to run next.

# Custom actions example
# These appear as subcommands under `muxctl ai <action-name>`
custom_actions:
  analyze-performance:
    description: "Analyze output for performance issues"
    max_lines: 500
    system_prompt: |
      You are a performance analysis expert.
    user_prompt: |
      Analyze the following output for performance issues:
      {{content}}
